<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus">


<title data-react-helmet="true">Background Service | Certify The Web Docs</title>

<meta data-react-helmet="true" http-equiv="x-ua-compatible" content="ie=edge"><meta data-react-helmet="true" property="og:title" content="Certify The Web Docs"><meta data-react-helmet="true" name="twitter:card" content="summary"><meta data-react-helmet="true" name="description" content="In order to perform certificate requests and automatic renewals we install a background service called &quot;Certify.Service&quot; (Certify SSL Manager Service). This service is installed to run as Local System and requires that the Local System account has the necessary privileges to administer IIS (if required) and the computers certificate store, as well as writing to the C:\ProgramData\Certify folder for configuration information."><meta data-react-helmet="true" property="og:description" content="In order to perform certificate requests and automatic renewals we install a background service called &quot;Certify.Service&quot; (Certify SSL Manager Service). This service is installed to run as Local System and requires that the Local System account has the necessary privileges to administer IIS (if required) and the computers certificate store, as well as writing to the C:\ProgramData\Certify folder for configuration information."><meta data-react-helmet="true" property="og:url" content="https://docs.certifytheweb.com/docs/backgroundservice">

<link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico">


<link rel="stylesheet" href="/styles.bf6750b6.css">


<link rel="preload" href="/styles.5fff5b5c.js" as="script">

<link rel="preload" href="/runtime~main.2183b836.js" as="script">

<link rel="preload" href="/main.deb28cb4.js" as="script">

<link rel="preload" href="/1.34ffacd0.js" as="script">

<link rel="preload" href="/2.cc2d5197.js" as="script">

<link rel="preload" href="/31.1d34200d.js" as="script">

<link rel="preload" href="/20ac7829.1f1cc3f2.js" as="script">

<link rel="preload" href="/17896441.12164747.js" as="script">

<link rel="preload" href="/c5c07e8d.380429ab.js" as="script">

</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=window.matchMedia("(prefers-color-scheme: dark)"),n=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();null!==n?t(n):e.matches&&t("dark")}()</script>
<div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a aria-current="page" class="navbar__brand active" href="/"><img class="navbar__logo" src="/img/logo.svg" alt="Certify The Web Logo"><strong class="navbar__title">Certify The Web - Docs</strong></a><a class="navbar__item navbar__link" href="/docs/intro">Getting Started</a><a class="navbar__item navbar__link" href="/docs/certificate-process">Requesting a Certificate</a><a class="navbar__item navbar__link" href="/docs/faq">FAQ</a><a class="navbar__item navbar__link" href="/docs/support">Support</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" target="_blank" rel="noopener noreferrer" href="https://community.certifytheweb.com">Community</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_1gtM"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_keGJ moon_1gwN"></span></div><div class="react-toggle-track-x"><span class="toggle_keGJ sun_3CPA"></span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a aria-current="page" class="navbar__brand active" href="/"><img class="navbar__logo" src="/img/logo.svg" alt="Certify The Web Logo"><strong class="navbar__title">Certify The Web - Docs</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/intro">Getting Started</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/certificate-process">Requesting a Certificate</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/faq">FAQ</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/support">Support</a></li><li class="menu__list-item"><a class="menu__link" target="_blank" rel="noopener noreferrer" href="https://community.certifytheweb.com">Community</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_1kjD"><div class="docSidebarContainer_1cYp"><div class="sidebar_1kLs"><div class="sidebarLogo_3ono"><img src="/img/logo.svg" alt="Certify The Web Logo"><strong>Certify The Web - Docs</strong></div><div class="menu menu--responsive menu_w2sC"><button aria-label="Open Menu" class="button button--secondary button--sm menu__button" type="button"><svg class="sidebarMenuIcon_2vk4" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Introduction</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/intro">Getting Started</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/letsencrypt">What is Let&#x27;s Encrypt?</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/certificate-process">Requesting a Certificate</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/ui-options">Guide to UI Options</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/renewals">Certificate Renewals</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Guides</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/dns-validation">About DNS Validation (dns-01)</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/http-validation">About HTTP Validation (http-01)</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/script-hooks">Scripting</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Useful Info</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/ssl-windows">Using Certificates in Windows</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/commandline">Command Line (CLI) Options</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/csv-import">CSV Bulk Import via Command Line</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active" href="/docs/backgroundservice">Background Service</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Support</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/faq">Frequently Asked Questions</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/support">Support Options</a></li></ul></li></ul></div></div></div><main class="docMainContainer_FFX1"><div class="padding-vert--lg"><div class="container"><div class="row"><div class="col docItemCol_2GOA"><div class="docItemContainer_2cwg"><article><header><h1 class="docTitle_1vWb">Background Service</h1></header><div class="markdown"><p>In order to perform certificate requests and automatic renewals we install a background service called &quot;Certify.Service&quot; (Certify SSL Manager Service). This service is installed to run as Local System and requires that the Local System account has the necessary privileges to administer IIS (if required) and the computers certificate store, as well as writing to the C:\ProgramData\Certify folder for configuration information.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="port-9696-is-the-default-service-port"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#port-9696-is-the-default-service-port" title="Direct link to heading">#</a>Port 9696 is the default service port</h2><p>By default the background service runs a local http API server on port 9696 for the UI to talk to (bound to localhost and requiring windows authentication). <em>Do not open this port to external traffic on your firewall.</em></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="custom-configuration-and-troubleshooting-service-not-started-error"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#custom-configuration-and-troubleshooting-service-not-started-error" title="Direct link to heading">#</a>Custom configuration and Troubleshooting &quot;..service not started&quot; error</h2><p>The certify background service operates a local API for the app on port <code>9696</code> by default. If this port is in use by another application/service (or for some other reason it cannot create a binding to <code>localhost:9696</code>, or a security product is preventing <strong>local</strong> port access) then you will see the message &#x27;Service not started&#x27;.</p><p>The app should try to negotiate a different service port if it detects that the port is already in use, however you can manually specify the settings if required by editing/adding the file <code>c:\programdata\certify\serviceconfig.json</code> with content as per the following (adjusted as required) then restarting both the service and UI:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-json codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token property">&quot;host&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;localhost&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token property">&quot;port&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token number" style="color:rgb(247, 140, 108)">9696</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></code></pre></div><p>For example an alternative configuration might be:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-json codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token property">&quot;host&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;127.0.0.1&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token property">&quot;port&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token number" style="color:rgb(247, 140, 108)">9695</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></code></pre></div><p>To test that the reconfigured service is communicating OK, you can try opening the following URL in your browser:
<code>http://localhost:9695/api/system/appversion</code> where &#x27;localhost&#x27; is your configured service <code>host</code> value and <code>9695</code> is an example configured port.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="other-considerations-for-service-not-started"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#other-considerations-for-service-not-started" title="Direct link to heading">#</a>Other Considerations for &#x27;Service Not Started..&#x27;</h2><p>To operate properly the background service needs to be able to register an http listener for it&#x27;s API server via http.sys, for that to work the IP address the service tries to use must be enabled as an http listen address and  in some versions of windows the Http kernel service may not be enabled and you will need to enable it. </p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="enable-http-listener-ip-address"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#enable-http-listener-ip-address" title="Direct link to heading">#</a>Enable http listener IP address</h3><p>As per <a href="https://docs.microsoft.com/en-us/windows/win32/http/add-iplisten">https://docs.microsoft.com/en-us/windows/win32/http/add-iplisten</a> enable any IP address to listen for http: </p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-bat codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">netsh http add iplisten ipaddress=0.0.0.0</span></div></code></pre></div><p>Or to target a specific IP address such as 127.0.0.1 (localhost):</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-bat codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">netsh http add iplisten ipaddress=127.0.0.1</span></div></code></pre></div><p>By default the windows http service is typically enabled but if you receive the error &#x27;Operation is not supported on this platform&#x27; in <code>service.exceptions.log</code> then try checking the status of the windows http service. To do so, run the following from an elevated command prompt (using Run As Administrator):</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-bat codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">sc query http</span></div></code></pre></div><p>This should produce output like:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-bat codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">SERVICE_NAME: http</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        TYPE               : 1  KERNEL_DRIVER</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        STATE              : 4  RUNNING</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                                (STOPPABLE, NOT_PAUSABLE, IGNORES_SHUTDOWN)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        WIN32_EXIT_CODE    : 0  (0x0)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        SERVICE_EXIT_CODE  : 0  (0x0)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        CHECKPOINT         : 0x0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        WAIT_HINT          : 0x0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></code></pre></div><p>If the state is not <code>RUNNING</code> use the following command the enable the service on demand:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-bat codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">sc config http start= demand</span></div></code></pre></div><p>Then start the http service</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-bat codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">net start http`</span></div></code></pre></div><p> If the service remains at <code>STOPPING</code> or similar then a system reboot may be required.</p><p> Once completed, restart the Certify SSL Manager background service from local services, then open the Certify The Web UI again to see if it can connect.</p><p> In other cases, you may have permission restrictions on port bindings to localhost, so you may have to modify these <a href="https://docs.microsoft.com/en-us/windows/desktop/http/add-urlacl">https://docs.microsoft.com/en-us/windows/desktop/http/add-urlacl</a> or change the service config as above.</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/webprofusion/certify-docs/edit/master/docs/backgroundservice.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/csv-import"><h5 class="pagination-nav__link--sublabel">Previous</h5><h4 class="pagination-nav__link--label">« CSV Bulk Import via Command Line</h4></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/faq"><h5 class="pagination-nav__link--sublabel">Next</h5><h4 class="pagination-nav__link--label">Frequently Asked Questions »</h4></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_TbNY"><ul class="contents contents__left-border"><li><a href="#port-9696-is-the-default-service-port" class="contents__link">Port 9696 is the default service port</a></li><li><a href="#custom-configuration-and-troubleshooting-service-not-started-error" class="contents__link">Custom configuration and Troubleshooting &quot;..service not started&quot; error</a></li><li><a href="#other-considerations-for-service-not-started" class="contents__link">Other Considerations for &#39;Service Not Started..&#39;</a><ul><li><a href="#enable-http-listener-ip-address" class="contents__link">Enable http listener IP address</a></li></ul></li></ul></div></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Getting Started</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/certificate-process">Requesting a Certificate</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/faq">FAQ</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/support">Support</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="https://community.certifytheweb.com">Discussions</a></li><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="https://github.com/webprofusion/certify">GitHub</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Social</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="https://github.com/webprofusion/certify">GitHub</a></li><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="https://twitter.com/certifytheweb">Twitter</a></li></ul></div></div><div class="text--center"><div>Copyright © 2020 Webprofusion Pty Ltd. Docs Built with Docusaurus.</div></div></div></footer>
</div>

<script src="/styles.5fff5b5c.js"></script>

<script src="/runtime~main.2183b836.js"></script>

<script src="/main.deb28cb4.js"></script>

<script src="/1.34ffacd0.js"></script>

<script src="/2.cc2d5197.js"></script>

<script src="/31.1d34200d.js"></script>

<script src="/20ac7829.1f1cc3f2.js"></script>

<script src="/17896441.12164747.js"></script>

<script src="/c5c07e8d.380429ab.js"></script>


</body>
</html>