<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus">


<title data-react-helmet="true">Using Certificates in Windows | Certify The Web Docs</title>

<meta data-react-helmet="true" http-equiv="x-ua-compatible" content="ie=edge"><meta data-react-helmet="true" property="og:title" content="Certify The Web Docs"><meta data-react-helmet="true" name="twitter:card" content="summary"><meta data-react-helmet="true" name="description" content="Using SSL/TLS certificates in Windows has a few aspects that can prevent your site working properly if don&#x27;t know about them. This guide outlines some key points. **See the special mention below for limitations regarding Windows Server 2008 R2 (IIS 7.5) and lower.**"><meta data-react-helmet="true" property="og:description" content="Using SSL/TLS certificates in Windows has a few aspects that can prevent your site working properly if don&#x27;t know about them. This guide outlines some key points. **See the special mention below for limitations regarding Windows Server 2008 R2 (IIS 7.5) and lower.**"><meta data-react-helmet="true" property="og:url" content="https://docs.certifytheweb.com/docs/ssl-windows">

<link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico">


<link rel="stylesheet" href="/styles.bf6750b6.css">


<link rel="preload" href="/styles.5fff5b5c.js" as="script">

<link rel="preload" href="/runtime~main.2183b836.js" as="script">

<link rel="preload" href="/main.deb28cb4.js" as="script">

<link rel="preload" href="/1.34ffacd0.js" as="script">

<link rel="preload" href="/2.cc2d5197.js" as="script">

<link rel="preload" href="/31.1d34200d.js" as="script">

<link rel="preload" href="/20ac7829.1f1cc3f2.js" as="script">

<link rel="preload" href="/17896441.12164747.js" as="script">

<link rel="preload" href="/8ee350a9.9c49d03f.js" as="script">

</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=window.matchMedia("(prefers-color-scheme: dark)"),n=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();null!==n?t(n):e.matches&&t("dark")}()</script>
<div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a aria-current="page" class="navbar__brand active" href="/"><img class="navbar__logo" src="/img/logo.svg" alt="Certify The Web Logo"><strong class="navbar__title">Certify The Web - Docs</strong></a><a class="navbar__item navbar__link" href="/docs/intro">Getting Started</a><a class="navbar__item navbar__link" href="/docs/certificate-process">Requesting a Certificate</a><a class="navbar__item navbar__link" href="/docs/faq">FAQ</a><a class="navbar__item navbar__link" href="/docs/support">Support</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" target="_blank" rel="noopener noreferrer" href="https://community.certifytheweb.com">Community</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_1gtM"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_keGJ moon_1gwN"></span></div><div class="react-toggle-track-x"><span class="toggle_keGJ sun_3CPA"></span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a aria-current="page" class="navbar__brand active" href="/"><img class="navbar__logo" src="/img/logo.svg" alt="Certify The Web Logo"><strong class="navbar__title">Certify The Web - Docs</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/intro">Getting Started</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/certificate-process">Requesting a Certificate</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/faq">FAQ</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/support">Support</a></li><li class="menu__list-item"><a class="menu__link" target="_blank" rel="noopener noreferrer" href="https://community.certifytheweb.com">Community</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_1kjD"><div class="docSidebarContainer_1cYp"><div class="sidebar_1kLs"><div class="sidebarLogo_3ono"><img src="/img/logo.svg" alt="Certify The Web Logo"><strong>Certify The Web - Docs</strong></div><div class="menu menu--responsive menu_w2sC"><button aria-label="Open Menu" class="button button--secondary button--sm menu__button" type="button"><svg class="sidebarMenuIcon_2vk4" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Introduction</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/intro">Getting Started</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/letsencrypt">What is Let&#x27;s Encrypt?</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/certificate-process">Requesting a Certificate</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/ui-options">Guide to UI Options</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/renewals">Certificate Renewals</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Guides</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/dns-validation">About DNS Validation (dns-01)</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/http-validation">About HTTP Validation (http-01)</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/script-hooks">Scripting</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Useful Info</a><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active" href="/docs/ssl-windows">Using Certificates in Windows</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/commandline">Command Line (CLI) Options</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/csv-import">CSV Bulk Import via Command Line</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/backgroundservice">Background Service</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Support</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/faq">Frequently Asked Questions</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/support">Support Options</a></li></ul></li></ul></div></div></div><main class="docMainContainer_FFX1"><div class="padding-vert--lg"><div class="container"><div class="row"><div class="col docItemCol_2GOA"><div class="docItemContainer_2cwg"><article><header><h1 class="docTitle_1vWb">Using Certificates in Windows</h1></header><div class="markdown"><p>Using SSL/TLS certificates in Windows has a few aspects that can prevent your site working properly if don&#x27;t know about them. This guide outlines some key points. <strong>See the special mention below for limitations regarding Windows Server 2008 R2 (IIS 7.5) and lower.</strong></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="there-can-be-only-one-ssl-binding-per-portip"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#there-can-be-only-one-ssl-binding-per-portip" title="Direct link to heading">#</a>There Can Be Only One (SSL Binding Per Port/IP)</h2><p>Windows only allows one SSL binding per specific IP, per Port (so typically port 443 for https). So if you use a fixed IP for your http website you probably don&#x27;t want to do that for your SSL binding as well, unless you have lots of spare IP addresses on the server (you probably don&#x27;t). This applies to all current versions of Windows.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="server-name-indication-sni"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#server-name-indication-sni" title="Direct link to heading">#</a>Server Name Indication (SNI)</h2><p>The good news is that if you <strong>do not specify a fixed IP for your binding</strong>, Windows can decide which website to match port 443 requests against using <strong>Server Name Indication (SNI)</strong>. This applies to Windows Server 2012 and higher, or versions running IIS 8.0 or higher.</p><p>If you use a binding of IP <em>All Unassigned</em> in IIS you can then share port 443 across multiple websites by also specifying the hostname to match against in your binding, and enabling SNI.</p><p>You can learn more about SNI in IIS 8.0 and higher here: <a href="https://docs.microsoft.com/en-us/iis/get-started/whats-new-in-iis-8/iis-80-server-name-indication-sni-ssl-scalability">https://docs.microsoft.com/en-us/iis/get-started/whats-new-in-iis-8/iis-80-server-name-indication-sni-ssl-scalability</a></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="binding-conflicts"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#binding-conflicts" title="Direct link to heading">#</a>Binding Conflicts</h2><p>Certify configures bindings with SNI enabled for you by default, but <strong>if you already have fixed IP bindings for SSL certificates look out for issues</strong>. Unless you have multiple IP addresses (which are not specifically bound to another SSL certificate) then creating any new certificate bindings will result in a conflict, and you could start seeing the wrong certificate being served by IIS for your website. </p><p><strong>IP binding conflicts are the number one reason for certificate confusion in Windows/IIS.</strong>
If your site is serving the wrong certificate this is probably the cause.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="invalid-private-key-permissions"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#invalid-private-key-permissions" title="Direct link to heading">#</a>Invalid Private Key Permissions</h2><p>If IIS cannot read or otherwise use the private key for your SSL certificate (either it&#x27;s corrupted or it was created by a different user account) it will fallback to the next SSL Certificate it can find. This usually results in the website being presented with the wrong certificate (and results in various security errors in the Web Browsers). If IIS can&#x27;t find another SSL certificate it will fail to serve any content at all. For this reason, be careful using non-standard accounts to create certificates. Changing the Certify SSL Manager background service to run under an alternative service account is not recommended or supported.</p><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="windows-server-2008-r2-iis-75-limitations"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#windows-server-2008-r2-iis-75-limitations" title="Direct link to heading">#</a>Windows Server 2008 R2 (IIS 7.5) Limitations</h1><p>Windows Server 2008 R2 and lower versions do not support SNI, so when a certificate binding is created it is associated with the IP address of the machine (actually the IP and port, usually port 443 for https). For this reason it is often difficult to use Server 2008 R2 or lower to host more than one https site.</p><p> Unless you have multiple IP addresses available on the machine (or you use a non-standard port) you will only be able to have one https/certificate binding in IIS. If two or more bindings point to the same certificate (for instance a Wildcard certificate, or a SAN certificate with multiple host names included), deleting one binding will also affect the other binding(s) and you will need to manually fix bindings.</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/webprofusion/certify-docs/edit/master/docs/ssl-windows.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/script-hooks"><h5 class="pagination-nav__link--sublabel">Previous</h5><h4 class="pagination-nav__link--label">« Scripting</h4></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/commandline"><h5 class="pagination-nav__link--sublabel">Next</h5><h4 class="pagination-nav__link--label">Command Line (CLI) Options »</h4></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_TbNY"><ul class="contents contents__left-border"><li><a href="#there-can-be-only-one-ssl-binding-per-portip" class="contents__link">There Can Be Only One (SSL Binding Per Port/IP)</a></li><li><a href="#server-name-indication-sni" class="contents__link">Server Name Indication (SNI)</a></li><li><a href="#binding-conflicts" class="contents__link">Binding Conflicts</a></li><li><a href="#invalid-private-key-permissions" class="contents__link">Invalid Private Key Permissions</a></li></ul></div></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Getting Started</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/certificate-process">Requesting a Certificate</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/faq">FAQ</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/support">Support</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="https://community.certifytheweb.com">Discussions</a></li><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="https://github.com/webprofusion/certify">GitHub</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Social</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="https://github.com/webprofusion/certify">GitHub</a></li><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="https://twitter.com/certifytheweb">Twitter</a></li></ul></div></div><div class="text--center"><div>Copyright © 2020 Webprofusion Pty Ltd. Docs Built with Docusaurus.</div></div></div></footer>
</div>

<script src="/styles.5fff5b5c.js"></script>

<script src="/runtime~main.2183b836.js"></script>

<script src="/main.deb28cb4.js"></script>

<script src="/1.34ffacd0.js"></script>

<script src="/2.cc2d5197.js"></script>

<script src="/31.1d34200d.js"></script>

<script src="/20ac7829.1f1cc3f2.js"></script>

<script src="/17896441.12164747.js"></script>

<script src="/8ee350a9.9c49d03f.js"></script>


</body>
</html>